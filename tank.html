 <!DOCTYPE html>
<html>
<head>
	<title>Tank</title>
	<link href="tank.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Secular+One&display=swap" rel="stylesheet">

	<style type="text/css">
		.output0{
			font-family: 'Secular One', sans-serif;
			font-size: 20px;
			border:none;
			background-color: #70AD22;
		}
		h3{
			font-family: 'Secular One', sans-serif;
		}	
		body{
			background-color: #70AD22;
		}
		
	</style>

<script type="text/javascript">
	var points = 0

	// health bar
	barX = 100;
	barY = 20;
	var arrow = 4; // 1- up, 2- right, 3 - down, 4- left
	var bodyX = 225;
	var bodyY = 215;

	var bulletNum = 0;
	var moveX = 0;
	var moveY = 0;

	var circleX = 250;
	var circleY = 250;

	var pipeX = 244;
	var pipeY = 210;
	
	var onOff = 0 * 1;
	var bulletX = 0 * 1;
	var bulletY = 0 * 1;

	// AI VARIABLES
	var arrowAI = 4 // 1- up, 2- right, 3 - down, 4- left
	var bodyXAI = 500;
	var bodyYAI = 215;

	var moveXAI = 0;
	var moveYAI = 0;

	var circleXAI = 525;
	var circleYAI = 250;

	var pipeXAI = 520
	var pipeYAI = 210;

	function FireBullet(){
		if (bulletNum == 0){

			if (arrow == 1){ // up
				moveY = -10
			}
			if (arrow == 3){ // down
				moveY = 10
			}
			if (arrow == 4){ // left
				moveX = -10
			}
			if (arrow == 2){ // right
				moveX = 10
			}
			bulletNum += 1;

		}

		bulletX += moveX
		bulletY += moveY
		// ADJUST THESE VALUES! ****
		if (Math.abs(bulletX - bodyXAI) < 50 && Math.abs(bulletY - bodyYAI) < 50){
			console.log("HIT")
			StartTimer();
			moveX = 0
			moveY = 0
			bulletX = circleX;
			bulletY = circleY;
			bulletNum = 0;
			points += 1;
			document.TankPoints.points.value = points;
		}


		if (bulletY < 0 || bulletY > 700 || bulletX > 700|| bulletX < 0){
			StartTimer();
			moveX = 0
			moveY = 0
			bulletX = circleX;
			bulletY = circleY;
			bulletNum = 0;
		}
		drawTank();
	}

	function init(){
		window.addEventListener('keydown', doKeyDown, true);
		drawTank();
	}

	function drawTank(LeftRight){
		// paints to the canvas
		var c = document.getElementById("myCanvas");
		var ctx = c.getContext("2d");

		ctx.canvas.width = 700;
		ctx.canvas.height = 500;

		ctx.fillStyle = "#AE7900";
		ctx.fillRect(0, 0, window.innerWidth, window.innerHeight); 

		// bullet
		if (onOff == 1){
			ctx.fillStyle="#000000";
			ctx.beginPath();
			ctx.arc(bulletX, bulletY ,5 ,0 ,Math.PI*2 ,true);
			ctx.closePath();
			ctx.fill();
		}

		// draw tank
			// LEFT
		if (arrow == 4){
			ctx.fillStyle = "#006320";
			ctx.fillRect(bodyX , bodyY ,75, 50); 
			ctx.fill()
			window.addEventListener('keydown', Move, true);

			ctx.fillStyle = "#008B2D";
			ctx.beginPath();
			ctx.arc(circleX+10, circleY-10, 17, 0, Math.PI* 2, true);
			ctx.closePath();
			window.addEventListener('keydown', Move, true);
			ctx.fillRect(pipeX-30, pipeY+25 ,55, 12); 
			ctx.fill()
			window.addEventListener('keydown', Move, true);

		}
		// UP
		else if (arrow == 1){
			ctx.fillStyle = "#006320";
			ctx.fillRect(bodyX, bodyY ,50, 75); 
			ctx.fill();
			window.addEventListener('keydown', Move, true);

			ctx.fillStyle = "#008B2D";
			ctx.beginPath();
			ctx.arc(circleX, circleY, 17, 0, Math.PI* 2, true);
			ctx.closePath();
			window.addEventListener('keydown', Move, true);
			ctx.fillRect(pipeX, pipeY ,12, 55); 
			ctx.fill();
			window.addEventListener('keydown', Move, true);
		}
		// RIGHT
		else if (arrow == 2){
			ctx.fillStyle = "#006320";
			ctx.fillRect(bodyX, bodyY ,75, 50); 
			ctx.fill();
			window.addEventListener('keydown', Move, true);

			ctx.fillStyle = "#008B2D";
			ctx.beginPath();
			ctx.arc(circleX +10, circleY-10, 17, 0, Math.PI* 2, true);
			ctx.closePath();
			window.addEventListener('keydown', Move, true);
			ctx.fillRect(pipeX+ 10, pipeY+25 ,55, 12); 
			ctx.fill();
			window.addEventListener('keydown', Move, true);
		}
		
		// DOWN
		else if (arrow == 3){
			ctx.fillStyle = "#006320";
			ctx.fillRect(bodyX, bodyY ,50, 75); 
			ctx.fill()
			window.addEventListener('keydown', Move, true);

			ctx.fillStyle = "#008B2D";
			ctx.beginPath();
			ctx.arc(circleX, circleY, 17, 0, Math.PI* 2, true);
			ctx.closePath();
			window.addEventListener('keydown', Move, true);
			ctx.fillRect(pipeX, pipeY+30 ,12, 55); 
			ctx.fill();
			window.addEventListener('keydown', Move, true);
		}

		// HEALTH BAR
			ctx.fillStyle = "#8EC72F";
			ctx.fillRect(10, 10, barX, barY); 
			ctx.fill()


		// draw AI
			// LEFT
		if (arrowAI == 4){ 
			ctx.fillStyle = "#008B2D";
			ctx.fillRect(bodyXAI , bodyYAI ,75, 50); 
			ctx.fill()
			window.addEventListener('keydown', Move, true);

			ctx.fillStyle = "#FF0000";
			ctx.beginPath();
			ctx.arc(circleXAI+10, circleYAI-10, 17, 0, Math.PI* 2, true);
			ctx.closePath();
			window.addEventListener('keydown', Move, true);
			ctx.fillRect(pipeXAI-30, pipeYAI+25 ,55, 12); 
			ctx.fill()
			window.addEventListener('keydown', Move, true);
		}
			// UP
		else if (arrowAI == 1){
			ctx.fillStyle = "#008B2D";
			ctx.fillRect(bodyXAI, bodyYAI ,50, 75); 
			ctx.fill();
			window.addEventListener('keydown', Move, true);

			ctx.fillStyle = "#FF0000";
			ctx.beginPath();
			ctx.arc(circleXAI, circleYAI, 17, 0, Math.PI* 2, true);
			ctx.closePath();
			window.addEventListener('keydown', Move, true);
			ctx.fillRect(pipeXAI, pipeYAI ,12, 55); 
			ctx.fill();
			window.addEventListener('keydown', Move, true);
		}
		// RIGHT
		else if (arrowAI == 2){
			ctx.fillStyle = "#008B2D";
			ctx.fillRect(bodyXAI, bodyYAI ,75, 50); 
			ctx.fill();
			window.addEventListener('keydown', Move, true);

			ctx.fillStyle = "#FF0000";
			ctx.beginPath();
			ctx.arc(circleXAI +10, circleYAI-10, 17, 0, Math.PI* 2, true);
			ctx.closePath();
			window.addEventListener('keydown', Move, true);
			ctx.fillRect(pipeXAI+ 10, pipeYAI+25 ,55, 12); 
			ctx.fill();
			window.addEventListener('keydown', Move, true);
		}
		// DOWN
		else if (arrowAI == 3){
			ctx.fillStyle = "#008B2D";
			ctx.fillRect(bodyXAI, bodyYAI ,50, 75); 
			ctx.fill()
			window.addEventListener('keydown', Move, true);

			ctx.fillStyle = "#FF0000";
			ctx.beginPath();
			ctx.arc(circleXAI, circleYAI, 17, 0, Math.PI* 2, true);
			ctx.closePath();
			window.addEventListener('keydown', Move, true);
			ctx.fillRect(pipeXAI, pipeYAI+30 ,12, 55); 
			ctx.fill();
			window.addEventListener('keydown', Move, true);
		}
	}

	function Move(){
		window.addEventListener('keydown', doKeyDown, true);
		drawTank();
	}

	function doKeyDown(evt){
		switch(evt.which)
		{
			case 37: //left arrow
				if (bodyX > 10){
					arrow = 4;
					bodyX -= 5;
					circleX -= 5;
					pipeX -= 5;
				}
			break;
			
			case 38: //up arrow
				if (bodyY > 10){
					arrow = 1;
					bodyY -= 5;
					circleY -= 5;
					pipeY -= 5;
				}
			break;
 			
			case 39: // right arrow
				if (bodyX < 625){
					arrow = 2;
					bodyX += 5;
					circleX += 5;
					pipeX += 5;
				}
			break;

			case 40: //down arrow
				if (bodyY < 425){
					arrow = 3;
					bodyY += 5;
					circleY += 5;
					pipeY += 5;
				}
			break;

			case 32: // shoot
				if(onOff == 0){
					StartTimer();
				}
			break;
		}

		if (onOff == 0){
			bulletX = circleX;
			bulletY = circleY;
		}	
		drawTank();
	}

	function Track(){
		// if AI to the right
		if (bodyXAI < bodyX){
			arrowAI = 2;
			bodyXAI += 1;
			circleXAI += 1;
			pipeXAI += 1;
		}
		else if (bodyXAI > bodyX){
			arrowAI = 4;
			bodyXAI -= 1;
			circleXAI -= 1;
			pipeXAI -= 1;
		}

		if (bodyYAI < bodyY){
			arrowAI = 3;
			bodyYAI += 1;
			circleYAI += 1;
			pipeYAI += 1;
		}
		else if (bodyYAI > bodyY){
			arrowAI = 1;
			bodyYAI -= 1;
			circleYAI -= 1;
			pipeYAI -= 1;
		}

		if (Math.abs(bodyX - bodyXAI) < 75 && Math.abs(bodyY - bodyYAI) < 75){
			barX -= 2;
			if (barX < 0){
				clearInterval(aiTimer);

				window.alert("You lost! :-(" + "\nRefresh the page to start again.")
			}
		}

		drawTank();
	}


	function TimerAI(){
		aiTimer = setInterval("Track()", 100)
	}

	function StartTimer(){
		if(onOff == 0){
			// creates timer variable
			timer = setInterval("FireBullet()", 100);
			onOff = 1 * 1;
		}
		else if(onOff == 1){
			clearInterval(timer);
			onOff = 0 * 1;
		}
	}
 
</script>

</head>
<body onload="init() , TimerAI()"> 
	<center>
	</br>
		<img style="width:400px" src="tankTitle.png">
		</br>
		</br>
		<canvas id="myCanvas" width="600" height="300" style="border:1px solid rgb(195, 195, 195);">
			Your browser does not support canvas element
		</canvas>
		</br>
		</br> 
		<table>
			<tr id="points">
				<th  id="points"><h3>Points: </h3></th>
				<th  id="points"> 		
					<form name="TankPoints">
						<textarea name="points" class="output0" id="outputFieldA" rows="1" cols="5"/></textarea>
					</form>
				</th>
			</tr>
		</table>

		
	</center>
</body>
</html>